"use strict";var assert=require("assert"),comments=require("./comments"),FastPath=require("./fast-path"),util=require("./util"),isIdentifierName=require("esutils").keyword.isIdentifierNameES6,docBuilders=require("./doc-builders"),concat=docBuilders.concat,join=docBuilders.join,line=docBuilders.line,hardline=docBuilders.hardline,softline=docBuilders.softline,literalline=docBuilders.literalline,group=docBuilders.group,indent=docBuilders.indent,conditionalGroup=docBuilders.conditionalGroup,ifBreak=docBuilders.ifBreak,breakParent=docBuilders.breakParent,docUtils=require("./doc-utils"),willBreak=docUtils.willBreak,isLineNext=docUtils.isLineNext,getFirstString=docUtils.getFirstString,isEmpty=docUtils.isEmpty,types=require("ast-types"),namedTypes=types.namedTypes,isString=types.builtInTypes.string,isObject=types.builtInTypes.object;function maybeAddParens(e,t){return e.needsParens()?concat(["(",t,")"]):t}function genericPrint(e,t,a){assert.ok(e instanceof FastPath);var l=e.getValue(),s=[],r=!1,o=genericPrintNoParens(e,t,a);if(!l||isEmpty(o))return o;if(l.decorators&&0<l.decorators.length&&!util.getParentExportDeclaration(e)){const c=1===l.decorators.length&&"Identifier"===l.decorators[0].expression.type?" ":hardline;e.each(function(u){s.push(a(u),c)},"decorators")}else util.isExportDeclaration(l)&&l.declaration&&l.declaration.decorators?e.each(function(c){s.push(a(c),line)},"declaration","decorators"):r=e.needsParens();return r&&s.unshift("("),s.push(o),r&&s.push(")"),concat(s)}function genericPrintNoParens(e,t,a){var l=e.getValue();if(!l)return"";if("string"==typeof l)return l;var s=[];switch(l.type){case"File":return e.call(a,"program");case"Program":return l.directives&&e.each(function(J){s.push(a(J),";",hardline),util.isNextLineEmpty(t.originalText,J.getValue())&&s.push(hardline)},"directives"),s.push(e.call(function(J){return printStatementSequence(J,t,a)},"body")),s.push(comments.printDanglingComments(e,t,!0)),s.push(hardline),concat(s);case"Noop":case"EmptyStatement":return"";case"ExpressionStatement":return concat([e.call(a,"expression"),";"]);case"ParenthesizedExpression":return concat(["(",e.call(a,"expression"),")"]);case"AssignmentExpression":return group(concat([e.call(a,"left")," ",l.operator," ",e.call(a,"right")]));case"BinaryExpression":case"LogicalExpression":{const J=[];return printBinaryishExpressions(e,J,a,t),group(concat([0<J.length?J[0]:"",indent(t.tabWidth,concat(J.slice(1)))]))}case"AssignmentPattern":return concat([e.call(a,"left")," = ",e.call(a,"right")]);case"MemberExpression":return concat([e.call(a,"object"),printMemberLookup(e,t,a)]);case"MetaProperty":return concat([e.call(a,"meta"),".",e.call(a,"property")]);case"BindExpression":return l.object&&s.push(e.call(a,"object")),s.push("::",e.call(a,"callee")),concat(s);case"Path":return join(".",l.body);case"Identifier":return concat([l.name,l.optional?"?":"",e.call(a,"typeAnnotation")]);case"SpreadElement":case"SpreadElementPattern":case"RestProperty":case"SpreadProperty":case"SpreadPropertyPattern":case"RestElement":return concat(["...",e.call(a,"argument"),e.call(a,"typeAnnotation")]);case"FunctionDeclaration":case"FunctionExpression":return l.async&&s.push("async "),s.push("function"),l.generator&&s.push("*"),l.id&&s.push(" ",e.call(a,"id")),s.push(e.call(a,"typeParameters"),group(concat([printFunctionParams(e,a,t),printReturnType(e,a)]))," ",e.call(a,"body")),concat(s);case"ArrowFunctionExpression":l.async&&s.push("async "),l.typeParameters&&s.push(e.call(a,"typeParameters")),1!==l.params.length||l.rest||"Identifier"!==l.params[0].type||l.params[0].typeAnnotation||l.params[0].leadingComments||l.params[0].trailingComments||l.predicate||l.returnType?s.push(group(concat([printFunctionParams(e,a,t),printReturnType(e,a)]))):s.push(e.call(a,"params",0)),s.push(" =>");const F=e.call(a,"body"),I=concat([concat(s)," ",F]);return"ArrayExpression"===l.body.type||"ObjectExpression"===l.body.type||"JSXElement"===l.body.type||"BlockStatement"===l.body.type?group(I):group(conditionalGroup([I,concat([concat(s),indent(t.tabWidth,concat([line,F]))])]),{shouldBreak:willBreak(F)});case"MethodDefinition":return l.static&&s.push("static "),s.push(printMethod(e,t,a)),concat(s);case"YieldExpression":return s.push("yield"),l.delegate&&s.push("*"),l.argument&&s.push(" ",e.call(a,"argument")),concat(s);case"AwaitExpression":return s.push("await"),l.all&&s.push("*"),l.argument&&s.push(" ",e.call(a,"argument")),concat(s);case"ModuleDeclaration":return s.push("module",e.call(a,"id")),l.source?(assert.ok(!l.body),s.push("from",e.call(a,"source"))):s.push(e.call(a,"body")),join(" ",s);case"ImportSpecifier":return l.imported?(s.push(e.call(a,"imported")),l.local&&l.local.name!==l.imported.name&&s.push(" as ",e.call(a,"local"))):l.id&&(s.push(e.call(a,"id")),l.name&&s.push(" as ",e.call(a,"name"))),concat(s);case"ExportSpecifier":return l.local?(s.push(e.call(a,"local")),l.exported&&l.exported.name!==l.local.name&&s.push(" as ",e.call(a,"exported"))):l.id&&(s.push(e.call(a,"id")),l.name&&s.push(" as ",e.call(a,"name"))),concat(s);case"ExportBatchSpecifier":return"*";case"ImportNamespaceSpecifier":return s.push("* as "),l.local?s.push(e.call(a,"local")):l.id&&s.push(e.call(a,"id")),concat(s);case"ImportDefaultSpecifier":return l.local?e.call(a,"local"):e.call(a,"id");case"ExportDeclaration":case"ExportDefaultDeclaration":case"ExportNamedDeclaration":return printExportDeclaration(e,t,a);case"ExportAllDeclaration":return s.push("export *"),l.exported&&s.push(" as ",e.call(a,"exported")),s.push(" from ",e.call(a,"source"),";"),concat(s);case"ExportNamespaceSpecifier":return concat(["* as ",e.call(a,"exported")]);case"ExportDefaultSpecifier":return e.call(a,"exported");case"ImportDeclaration":s.push("import ");const X=[];l.importKind&&"value"!==l.importKind&&s.push(l.importKind+" ");var r=[],o=[];return l.specifiers&&0<l.specifiers.length&&(e.each(function(J){var q=J.getValue();namedTypes.ImportDefaultSpecifier.check(q)||namedTypes.ImportNamespaceSpecifier.check(q)?r.push(a(J)):o.push(a(J))},"specifiers"),0<r.length&&s.push(join(", ",r)),0<r.length&&0<o.length&&s.push(", "),0<o.length&&s.push(group(concat(["{",indent(t.tabWidth,concat([t.bracketSpacing?line:softline,join(concat([",",line]),o)])),ifBreak(t.trailingComma?",":""),t.bracketSpacing?line:softline,"}"]))),X.push(0===o.length?line:" ","from ")),X.push(e.call(a,"source"),";"),0===o.length?group(concat([concat(s),indent(t.tabWidth,concat(X))])):concat([concat(s),concat(X)]);case"Import":return"import";case"BlockStatement":{var c=e.call(function(R){return printStatementSequence(R,t,a)},"body");const J=getFirstString(c),q=l.directives&&0<l.directives.length;var u=e.getParentNode();return J||q||l.comments||"ArrowFunctionExpression"!==u.type&&"FunctionExpression"!==u.type&&"FunctionDeclaration"!==u.type?(s.push("{"),q&&e.each(function(R){s.push(indent(t.tabWidth,concat([hardline,a(R),";"])))},"directives"),J&&s.push(indent(t.tabWidth,concat([hardline,c]))),s.push(comments.printDanglingComments(e,t)),s.push(hardline,"}"),concat(s)):"{}"}case"ReturnStatement":return s.push("return"),l.argument&&s.push(" ",e.call(a,"argument")),s.push(";"),concat(s);case"CallExpression":{e.getParentNode();return"MemberExpression"===l.callee.type?printMemberChain(e,t,a):concat([e.call(a,"callee"),printArgumentsList(e,t,a)])}case"ObjectExpression":case"ObjectPattern":case"ObjectTypeAnnotation":var d="ObjectTypeAnnotation"===l.type,m=d?",":",",y=[],g=l.exact?"{|":"{",x=l.exact?"|}":"}";d&&y.push("indexers","callProperties"),y.push("properties");var b=[];y.forEach(function(J){e.each(function(q){b.push(group(a(q)))},J)});const W=util.getLast(l.properties),j=!(W&&"RestProperty"===W.type),V=util.hasNewlineInRange(t.originalText,util.locStart(l),util.locEnd(l));return 0===b.length?group(concat(["{",comments.printDanglingComments(e,t),softline,"}"])):group(concat([g,indent(t.tabWidth,concat([t.bracketSpacing?line:softline,join(concat([m,line]),b)])),ifBreak(j&&t.trailingComma?",":""),t.bracketSpacing?line:softline,x,e.call(a,"typeAnnotation")]),{shouldBreak:V});case"PropertyPattern":return concat([e.call(a,"key"),": ",e.call(a,"pattern")]);case"ObjectProperty":case"Property":if(l.method||"get"===l.kind||"set"===l.kind)return printMethod(e,t,a);if(l.shorthand)s.push(e.call(a,"value"));else{l.computed?s.push("[",e.call(a,"key"),"]"):s.push(printPropertyKey(e,t,a));let J=e.call(a,"value");shouldPrintSameLine(l.value)?s.push(concat([": ",J])):s.push(concat([":",ifBreak(" ("," "),indent(t.tabWidth,concat([softline,J])),softline,ifBreak(")")]))}return concat(s);case"ClassMethod":return l.static&&s.push("static "),s=s.concat(printObjectMethod(e,t,a)),concat(s);case"ObjectMethod":return printObjectMethod(e,t,a);case"Decorator":return concat(["@",e.call(a,"expression")]);case"ArrayExpression":case"ArrayPattern":if(0===l.elements.length)s.push(concat(["[",comments.printDanglingComments(e,t),"]"]));else{const J=util.getLast(l.elements),q=!(J&&"RestElement"===J.type),R=q&&null===J;s.push(group(concat(["[",indent(t.tabWidth,concat([softline,join(concat([",",line]),e.map(a,"elements"))])),R?",":"",ifBreak(q&&!R&&t.trailingComma?",":""),softline,"]"])))}return l.typeAnnotation&&s.push(e.call(a,"typeAnnotation")),concat(s);case"SequenceExpression":return join(", ",e.map(a,"expressions"));case"ThisExpression":return"this";case"Super":return"super";case"NullLiteral":return"null";case"RegExpLiteral":return l.extra.raw;case"NumericLiteral":return printNumber(l.extra.raw);case"BooleanLiteral":case"StringLiteral":case"Literal":return"number"==typeof l.value?printNumber(l.raw):"string"==typeof l.value?nodeStr(l,t):""+l.value;case"Directive":return e.call(a,"value");case"DirectiveLiteral":return nodeStr(l,t);case"ModuleSpecifier":if(l.local)throw new Error("The ESTree ModuleSpecifier type should be abstract");return nodeStr(l,t);case"UnaryExpression":return s.push(l.operator),/[a-z]$/.test(l.operator)&&s.push(" "),s.push(e.call(a,"argument")),concat(s);case"UpdateExpression":return s.push(e.call(a,"argument"),l.operator),l.prefix&&s.reverse(),concat(s);case"ConditionalExpression":return group(concat([e.call(a,"test"),indent(t.tabWidth,concat([line,"? ",indent(2,e.call(a,"consequent")),line,": ",indent(2,e.call(a,"alternate"))]))]));case"NewExpression":s.push("new ",e.call(a,"callee"));var E=l.arguments;return E&&s.push(printArgumentsList(e,t,a)),concat(s);case"VariableDeclaration":var S=e.map(function(J){return a(J)},"declarations");s=[l.kind," ",S[0],indent(t.tabWidth,concat(S.slice(1).map(J=>concat([",",line,J]))))];var A=e.getParentNode(),T=namedTypes.ForStatement.check(A)||namedTypes.ForInStatement.check(A)||namedTypes.ForOfStatement&&namedTypes.ForOfStatement.check(A)||namedTypes.ForAwaitStatement&&namedTypes.ForAwaitStatement.check(A);return T&&A.body!==l||s.push(";"),group(concat(s));case"VariableDeclarator":return l.init?concat([e.call(a,"id")," = ",e.call(a,"init")]):e.call(a,"id");case"WithStatement":return concat(["with (",e.call(a,"object"),")",adjustClause(e.call(a,"body"),t)]);case"IfStatement":const B=adjustClause(e.call(a,"consequent"),t);if(s=["if (",group(concat([indent(t.tabWidth,concat([softline,e.call(a,"test")])),softline])),")",B],l.alternate){const J=isCurlyBracket(B),q=isEmptyBlock(B);J&&!q?s.push(" else"):s.push(conditionalGroup([concat([hardline,"else"])])),s.push(adjustClause(e.call(a,"alternate"),t,"IfStatement"===l.alternate.type))}return group(concat(s));case"ForStatement":{const J=adjustClause(e.call(a,"body"),t);return l.init||l.test||l.update?concat(["for (",group(concat([indent(t.tabWidth,concat([softline,e.call(a,"init"),";",line,e.call(a,"test"),";",line,e.call(a,"update")])),softline])),")",J]):concat(["for (;;)",J])}case"WhileStatement":return concat(["while (",group(concat([indent(t.tabWidth,concat([softline,e.call(a,"test")])),softline])),")",adjustClause(e.call(a,"body"),t)]);case"ForInStatement":return concat([l.each?"for each (":"for (",e.call(a,"left")," in ",e.call(a,"right"),")",adjustClause(e.call(a,"body"),t)]);case"ForOfStatement":return concat(["for (",e.call(a,"left")," of ",e.call(a,"right"),")",adjustClause(e.call(a,"body"),t)]);case"ForAwaitStatement":return concat(["for await (",e.call(a,"left")," of ",e.call(a,"right"),")",adjustClause(e.call(a,"body"),t)]);case"DoWhileStatement":var P=adjustClause(e.call(a,"body"),t),v=concat(["do",P]),s=[v];const O=isCurlyBracket(P);return O?s.push(" while"):s.push(concat([line,"while"])),s.push(" (",e.call(a,"test"),");"),concat(s);case"DoExpression":var D=e.call(function(J){return printStatementSequence(J,t,a)},"body");return concat(["do {\n",D.indent(t.tabWidth),"\n}"]);case"BreakStatement":return s.push("break"),l.label&&s.push(" ",e.call(a,"label")),s.push(";"),concat(s);case"ContinueStatement":return s.push("continue"),l.label&&s.push(" ",e.call(a,"label")),s.push(";"),concat(s);case"LabeledStatement":return"EmptyStatement"===l.body.type?concat([e.call(a,"label"),":;"]):concat([e.call(a,"label"),":",hardline,e.call(a,"body")]);case"TryStatement":return s.push("try ",e.call(a,"block")),l.handler?s.push(" ",e.call(a,"handler")):l.handlers&&e.each(function(J){s.push(" ",a(J))},"handlers"),l.finalizer&&s.push(" finally ",e.call(a,"finalizer")),concat(s);case"CatchClause":return s.push("catch (",e.call(a,"param")),l.guard&&s.push(" if ",e.call(a,"guard")),s.push(") ",e.call(a,"body")),concat(s);case"ThrowStatement":return concat(["throw ",e.call(a,"argument"),";"]);case"SwitchStatement":return concat(["switch (",e.call(a,"discriminant"),") {",0<l.cases.length?indent(t.tabWidth,concat([hardline,join(hardline,e.map(a,"cases"))])):"",hardline,"}"]);case"SwitchCase":if(l.test?s.push("case ",e.call(a,"test"),":"):s.push("default:"),l.consequent.find(J=>"EmptyStatement"!==J.type)){const J=e.call(function(q){return printStatementSequence(q,t,a)},"consequent");s.push(isCurlyBracket(J)?concat([" ",J]):indent(t.tabWidth,concat([hardline,J])))}return concat(s);case"DebuggerStatement":return"debugger;";case"JSXAttribute":if(s.push(e.call(a,"name")),l.value){let J;J=("StringLiteral"===l.value.type||"Literal"===l.value.type)&&"string"==typeof l.value.value?"\""+util.htmlEscapeInsideDoubleQuote(l.value.value)+"\"":e.call(a,"value"),s.push("=",J)}return concat(s);case"JSXIdentifier":return""+l.name;case"JSXNamespacedName":return join(":",[e.call(a,"namespace"),e.call(a,"name")]);case"JSXMemberExpression":return join(".",[e.call(a,"object"),e.call(a,"property")]);case"JSXSpreadAttribute":return concat(["{...",e.call(a,"argument"),"}"]);case"JSXExpressionContainer":{const J=e.getParentNode(0),q="ArrayExpression"===l.expression.type||"ObjectExpression"===l.expression.type||"ArrowFunctionExpression"===l.expression.type||"CallExpression"===l.expression.type||"FunctionExpression"===l.expression.type||"JSXEmptyExpression"===l.expression.type||"JSXElement"===J.type&&("ConditionalExpression"===l.expression.type||"LogicalExpression"===l.expression.type);return q?group(concat(["{",e.call(a,"expression"),"}"])):group(concat(["{",indent(t.tabWidth,concat([softline,e.call(a,"expression")])),softline,"}"]))}case"JSXElement":{const J=printJSXElement(e,t,a);return maybeWrapJSXElementInParens(e,J,t)}case"JSXOpeningElement":{const J=e.getValue();return 1===J.attributes.length&&J.attributes[0].value&&"Literal"===J.attributes[0].value.type&&"string"==typeof J.attributes[0].value.value?group(concat(["<",e.call(a,"name")," ",concat(e.map(a,"attributes")),J.selfClosing?" />":">"])):group(concat(["<",e.call(a,"name"),concat([indent(t.tabWidth,concat(e.map(q=>concat([line,a(q)]),"attributes"))),J.selfClosing?line:softline]),J.selfClosing?"/>":">"]))}case"JSXClosingElement":return concat(["</",e.call(a,"name"),">"]);case"JSXText":throw new Error("JSXTest should be handled by JSXElement");case"JSXEmptyExpression":return concat([comments.printDanglingComments(e,t),softline]);case"TypeAnnotatedIdentifier":return concat([e.call(a,"annotation")," ",e.call(a,"identifier")]);case"ClassBody":return l.comments||0!==l.body.length?concat(["{",0<l.body.length?indent(t.tabWidth,concat([hardline,e.call(function(J){return printStatementSequence(J,t,a)},"body")])):comments.printDanglingComments(e,t),hardline,"}"]):"{}";case"ClassPropertyDefinition":return s.push("static ",e.call(a,"definition")),namedTypes.MethodDefinition.check(l.definition)||s.push(";"),concat(s);case"ClassProperty":l.static&&s.push("static ");var C;return l.computed?C=concat(["[",e.call(a,"key"),"]"]):(C=printPropertyKey(e,t,a),"plus"===l.variance?C=concat(["+",C]):"minus"===l.variance&&(C=concat(["-",C]))),s.push(C),l.typeAnnotation&&s.push(e.call(a,"typeAnnotation")),l.value&&s.push(" = ",e.call(a,"value")),s.push(";"),concat(s);case"ClassDeclaration":case"ClassExpression":return concat(printClass(e,t,a));case"TemplateElement":return join(literalline,l.value.raw.split("\n"));case"TemplateLiteral":var L=e.map(a,"expressions");return s.push("`"),e.each(function(J){var q=J.getName();s.push(a(J)),q<L.length&&s.push("${",L[q],"}")},"quasis"),s.push("`"),concat(s);case"TaggedTemplateExpression":return concat([e.call(a,"tag"),e.call(a,"quasi")]);case"Node":case"Printable":case"SourceLocation":case"Position":case"Statement":case"Function":case"Pattern":case"Expression":case"Declaration":case"Specifier":case"NamedSpecifier":case"Comment":case"MemberTypeAnnotation":case"Type":throw new Error("unprintable type: "+JSON.stringify(l.type));case"TypeAnnotation":return l.typeAnnotation?("FunctionTypeAnnotation"!==l.typeAnnotation.type&&s.push(": "),s.push(e.call(a,"typeAnnotation")),concat(s)):"";case"TupleTypeAnnotation":return concat(["[",join(", ",e.map(a,"types")),"]"]);case"ExistentialTypeParam":case"ExistsTypeAnnotation":return"*";case"EmptyTypeAnnotation":return"empty";case"AnyTypeAnnotation":return"any";case"MixedTypeAnnotation":return"mixed";case"ArrayTypeAnnotation":return concat([e.call(a,"elementType"),"[]"]);case"BooleanTypeAnnotation":return"boolean";case"NumericLiteralTypeAnnotation":case"BooleanLiteralTypeAnnotation":return""+l.value;case"DeclareClass":return printFlowDeclaration(e,printClass(e,t,a));case"DeclareFunction":return printFlowDeclaration(e,["function ",e.call(a,"id"),l.predicate?" ":"",e.call(a,"predicate"),";"]);case"DeclareModule":return printFlowDeclaration(e,["module ",e.call(a,"id")," ",e.call(a,"body")]);case"DeclareModuleExports":return printFlowDeclaration(e,["module.exports",e.call(a,"typeAnnotation"),";"]);case"DeclareVariable":return printFlowDeclaration(e,["var ",e.call(a,"id"),";"]);case"DeclareExportAllDeclaration":return concat(["declare export * from ",e.call(a,"source")]);case"DeclareExportDeclaration":return concat(["declare ",printExportDeclaration(e,t,a)]);case"FunctionTypeAnnotation":var u=e.getParentNode(0),k=!(!u.variance&&!u.optional&&namedTypes.ObjectTypeProperty.check(u)||namedTypes.ObjectTypeCallProperty.check(u)||namedTypes.DeclareFunction.check(e.getParentNode(2))),N=k&&namedTypes.TypeAnnotation.check(u);return isObjectTypePropertyAFunction(u)&&(k=!0,N=!0),N&&s.push(": "),s.push(e.call(a,"typeParameters")),s.push(group(printFunctionParams(e,a,t))),(l.returnType||l.predicate)&&s.push(k?" => ":": ",e.call(a,"returnType"),e.call(a,"predicate")),concat(s);case"FunctionTypeParam":return concat([e.call(a,"name"),l.optional?"?":"",l.name?": ":"",e.call(a,"typeAnnotation")]);case"GenericTypeAnnotation":return concat([e.call(a,"id"),e.call(a,"typeParameters")]);case"DeclareInterface":case"InterfaceDeclaration":{const J=e.getParentNode(1);return J&&"DeclareModule"===J.type&&s.push("declare "),s.push("interface ",e.call(a,"id"),e.call(a,"typeParameters")," "),0<l["extends"].length&&s.push("extends ",join(", ",e.map(a,"extends"))," "),s.push(e.call(a,"body")),concat(s)}case"ClassImplements":case"InterfaceExtends":return concat([e.call(a,"id"),e.call(a,"typeParameters")]);case"IntersectionTypeAnnotation":case"UnionTypeAnnotation":{const J=e.map(a,"types"),q="IntersectionTypeAnnotation"===l.type?"&":"|";return group(indent(t.tabWidth,concat([ifBreak(concat([line,q," "])),join(concat([line,q," "]),J)])))}case"NullableTypeAnnotation":return concat(["?",e.call(a,"typeAnnotation")]);case"NullLiteralTypeAnnotation":return"null";case"ThisTypeAnnotation":return"this";case"NumberTypeAnnotation":return"number";case"ObjectTypeCallProperty":return l.static&&s.push("static "),s.push(e.call(a,"value")),concat(s);case"ObjectTypeIndexer":var M="plus"===l.variance?"+":"minus"===l.variance?"-":"";return concat([M,"[",e.call(a,"id"),l.id?": ":"",e.call(a,"key"),"]: ",e.call(a,"value")]);case"ObjectTypeProperty":var M="plus"===l.variance?"+":"minus"===l.variance?"-":"",w=!l.variance&&!l.optional&&"FunctionTypeAnnotation"===l.value.type;return isObjectTypePropertyAFunction(l)&&(w=!0),concat([l.static?"static ":"",M,e.call(a,"key"),l.optional?"?":"",w?"":": ",e.call(a,"value")]);case"QualifiedTypeIdentifier":return concat([e.call(a,"qualification"),".",e.call(a,"id")]);case"StringLiteralTypeAnnotation":return nodeStr(l,t);case"NumberLiteralTypeAnnotation":return assert.strictEqual(typeof l.value,"number"),""+l.value;case"StringTypeAnnotation":return"string";case"DeclareTypeAlias":case"TypeAlias":{const J=e.getParentNode(1);return J&&"DeclareModule"===J.type&&s.push("declare "),s.push("type ",e.call(a,"id"),e.call(a,"typeParameters")," = ",e.call(a,"right"),";"),concat(s)}case"TypeCastExpression":return concat(["(",e.call(a,"expression"),e.call(a,"typeAnnotation"),")"]);case"TypeParameterDeclaration":case"TypeParameterInstantiation":return concat(["<",join(", ",e.map(a,"params")),">"]);case"TypeParameter":switch(l.variance){case"plus":s.push("+");break;case"minus":s.push("-");break;default:}return s.push(e.call(a,"name")),l.bound&&s.push(e.call(a,"bound")),l["default"]&&s.push("=",e.call(a,"default")),concat(s);case"TypeofTypeAnnotation":return concat(["typeof ",e.call(a,"argument")]);case"VoidTypeAnnotation":return"void";case"NullTypeAnnotation":return"null";case"InferredPredicate":return"%checks";case"DeclaredPredicate":return concat(["%checks(",e.call(a,"value"),")"]);case"ClassHeritage":case"ComprehensionBlock":case"ComprehensionExpression":case"Glob":case"GeneratorExpression":case"LetStatement":case"LetExpression":case"GraphExpression":case"GraphIndexExpression":case"XMLDefaultDeclaration":case"XMLAnyName":case"XMLQualifiedIdentifier":case"XMLFunctionQualifiedIdentifier":case"XMLAttributeSelector":case"XMLFilterExpression":case"XML":case"XMLElement":case"XMLList":case"XMLEscape":case"XMLText":case"XMLStartTag":case"XMLEndTag":case"XMLPointTag":case"XMLName":case"XMLAttribute":case"XMLCdata":case"XMLComment":case"XMLProcessingInstruction":default:debugger;throw new Error("unknown type: "+JSON.stringify(l.type));}return p}function printStatementSequence(e,t,a){let l=[];return e.map(function(s){var o=s.getValue();if(o&&"EmptyStatement"!==o.type){const c=a(s),u=t.originalText,h=[];h.push(c),util.isNextLineEmpty(u,o)&&!isLastStatement(s)&&h.push(hardline),l.push(concat(h))}}),join(hardline,l)}function printPropertyKey(e,t,a){const l=e.getNode(),s=l.key;return("StringLiteral"===s.type||"Literal"===s.type&&"string"==typeof s.value)&&isIdentifierName(s.value)&&!l.computed&&("flow"!==t.parser||s.value.match(/[a-zA-Z0-9$_]/))?s.value:e.call(a,"key")}function printMethod(e,t,a){var l=e.getNode(),s=l.kind,r=[];"ObjectMethod"===l.type||"ClassMethod"===l.type?l.value=l:namedTypes.FunctionExpression.assert(l.value),l.value.async&&r.push("async "),s&&"init"!==s&&"method"!==s&&"constructor"!==s?(assert.ok("get"===s||"set"===s),r.push(s," ")):l.value.generator&&r.push("*");var o=printPropertyKey(e,t,a);return l.computed&&(o=concat(["[",o,"]"])),r.push(o,e.call(a,"value","typeParameters"),group(concat([e.call(function(c){return printFunctionParams(c,a,t)},"value"),e.call(c=>printReturnType(c,a),"value")]))," ",e.call(a,"value","body")),concat(r)}function printArgumentsList(e,t,a){var l=e.map(a,"arguments");if(0===l.length)return"()";const r=util.getLast(e.getValue().arguments),o=(!r.comments||!r.comments.length)&&("ObjectExpression"===r.type||"ArrayExpression"===r.type||"FunctionExpression"===r.type||"ArrowFunctionExpression"===r.type&&("BlockStatement"===r.body.type||"ArrowFunctionExpression"===r.body.type||"ObjectExpression"===r.body.type||"ArrayExpression"===r.body.type||"CallExpression"===r.body.type||"JSXElement"===r.body.type)||"NewExpression"===r.type);if(o){const c=l.slice(0,-1).some(willBreak);return concat([l.some(willBreak)?breakParent:"",conditionalGroup([concat(["(",join(concat([", "]),l),")"]),concat(["(",join(concat([",",line]),l.slice(0,-1)),1<l.length?", ":"",group(util.getLast(l),{shouldBreak:!0}),")"]),group(concat(["(",indent(t.tabWidth,concat([line,join(concat([",",line]),l)])),t.trailingComma?",":"",line,")"]),{shouldBreak:!0})],{shouldBreak:c})])}return group(concat(["(",indent(t.tabWidth,concat([softline,join(concat([",",line]),l)])),ifBreak(t.trailingComma?",":""),softline,")"]),{shouldBreak:l.some(willBreak)})}function printFunctionParams(e,t,a){var l=e.getValue(),s=e.map(t,"params");if(l.defaults&&e.each(function(c){var u=c.getName(),h=s[u];h&&c.getValue()&&(s[u]=concat([h," = ",t(c)]))},"defaults"),l.rest&&s.push(concat(["...",e.call(t,"rest")])),0===s.length)return"()";const r=util.getLast(e.getValue().params),o=!(r&&"RestElement"===r.type)&&!l.rest;return concat(["(",indent(a.tabWidth,concat([softline,join(concat([",",line]),s)])),ifBreak(o&&a.trailingComma?",":""),softline,")"])}function printObjectMethod(e,t,a){var l=e.getValue(),s=[];if(l.async&&s.push("async "),l.generator&&s.push("*"),l.method||"get"===l.kind||"set"===l.kind)return printMethod(e,t,a);var r=printPropertyKey(e,t,a);return l.computed?s.push("[",r,"]"):s.push(r),l.typeParameters&&s.push(e.call(a,"typeParameters")),s.push(group(concat([printFunctionParams(e,a,t),printReturnType(e,a)]))," ",e.call(a,"body")),concat(s)}function printReturnType(e,t){const a=e.getValue(),l=[e.call(t,"returnType")];return a.predicate&&l.push(a.returnType?" ":": ",e.call(t,"predicate")),concat(l)}function typeIsFunction(e){return"FunctionExpression"===e||"ArrowFunctionExpression"===e||"NewExpression"===e}function printExportDeclaration(e,t,a){var l=e.getValue(),s=["export "];return namedTypes.Declaration.assert(l),(l["default"]||"ExportDefaultDeclaration"===l.type)&&s.push("default "),l.declaration?(s.push(e.call(a,"declaration")),"ExportDefaultDeclaration"===l.type&&"ClassDeclaration"!==l.declaration.type&&"FunctionDeclaration"!==l.declaration.type&&s.push(";")):(l.specifiers&&0<l.specifiers.length?1===l.specifiers.length&&"ExportBatchSpecifier"===l.specifiers[0].type?s.push("*"):1===l.specifiers.length&&"ExportDefaultSpecifier"===l.specifiers[0].type||"ExportNamespaceSpecifier"===l.specifiers[0].type?s.push(e.map(a,"specifiers")[0]):s.push("type"===l.exportKind?"type ":"",group(concat(["{",indent(t.tabWidth,concat([t.bracketSpacing?line:softline,join(concat([",",line]),e.map(a,"specifiers"))])),ifBreak(t.trailingComma?",":""),t.bracketSpacing?line:softline,"}"]))):s.push("{}"),l.source&&s.push(" from ",e.call(a,"source")),s.push(";")),concat(s)}function printFlowDeclaration(e,t){var a=util.getParentExportDeclaration(e);return a?assert.strictEqual(a.type,"DeclareExportDeclaration"):t.unshift("declare "),concat(t)}function printClass(e,t,a){const l=e.getValue(),s=["class"];l.id&&s.push(" ",e.call(a,"id"),e.call(a,"typeParameters"));const r=[];return l.superClass?r.push(line,"extends ",e.call(a,"superClass"),e.call(a,"superTypeParameters")):l.extends&&0<l.extends.length&&r.push(line,"extends ",join(", ",e.map(a,"extends"))),l["implements"]&&0<l["implements"].length&&r.push(line,"implements ",join(", ",e.map(a,"implements"))),0<r.length&&s.push(group(indent(t.tabWidth,concat(r)))),s.push(" ",e.call(a,"body")),s}function printMemberLookup(e,t,a){const l=e.call(a,"property"),s=e.getValue();return concat(s.computed?["[",group(concat([indent(t.tabWidth,concat([softline,l])),softline])),"]"]:[".",l])}function printMemberChain(e,t,a){function l(g){const x=g.getValue();"CallExpression"===x.type?(r.unshift({node:x,printed:comments.printComments(g,()=>printArgumentsList(g,t,a),t)}),g.call(f=>l(f),"callee")):"MemberExpression"===x.type?(r.unshift({node:x,printed:comments.printComments(g,()=>printMemberLookup(g,t,a),t)}),g.call(f=>l(f),"object")):r.unshift({node:x,printed:g.call(a)})}function s(g){return concat(g.map(x=>x.printed))}const r=[];r.unshift({node:e.getValue(),printed:printArgumentsList(e,t,a)}),e.call(g=>l(g),"callee");for(var o=[],c=[r[0]],u=1;u<r.length&&"CallExpression"===r[u].node.type;++u)c.push(r[u]);for(;u+1<r.length&&"MemberExpression"===r[u].node.type&&"MemberExpression"===r[u+1].node.type;++u)c.push(r[u]);o.push(c),c=[];for(var h=!1;u<r.length;++u)h&&"MemberExpression"===r[u].node.type&&(o.push(c),c=[],h=!1),"CallExpression"===r[u].node.type&&(h=!0),c.push(r[u]);0<c.length&&o.push(c),1===o[0].length&&"Identifier"===o[0][0].node.type&&o[0][0].node.name.match(/(^[A-Z])|^[_$]+$/)&&2<=o.length&&([].unshift.apply(o[1],o[0]),o.splice(0,1));const d=o.map(s),m=concat(d);if(2>=o.length)return group(m);const y=concat([s(o[0]),indent(t.tabWidth,group(concat([hardline,join(hardline,o.slice(1).map(s))])))]);return d.slice(0,-1).some(willBreak)?group(y):conditionalGroup([m,y])}function isEmptyJSXElement(e){if(0===e.children.length)return!0;if(1<e.children.length)return!1;const t=e.children[0].value;return!/\S/.test(t)&&/\n/.test(t)}function printJSXChildren(e,t,a){const l=e.getValue(),s=[],r=t.singleQuote?ifBreak("{' '}"," "):ifBreak("{\" \"}"," ");return e.map(function(o,c){const u=o.getValue(),h=namedTypes.Literal.check(u);if(h&&"string"==typeof u.value){const d="flow"===t.parser?u.raw:util.htmlEscapeInsideAngleBracket(u.value),m=d.replace(/\u00a0/g,"&nbsp;");/\S/.test(m)?m.split(/(\n\s*)/).forEach(y=>{const g=y.match(/\n/g);if(g)return s.push(hardline),void(1<g.length&&s.push(hardline));const x=/^\s+/.test(y);x&&s.push(r);const f=y.replace(/^\s+|\s+$/g,"");f&&s.push(f);const b=/\s+$/.test(y);b&&s.push(r),s.push(softline)}):/\n/.test(m)?(s.push(hardline),1<m.match(/\n/g).length&&s.push(hardline)):/\s/.test(m)&&(s.push(r),s.push(softline))}else{s.push(a(o));let d=l.children[c+1];d&&/^\s*\n/.test(d.value)||s.push(softline)}},"children"),s}function printJSXElement(e,t,a){const l=e.getValue();isEmptyJSXElement(l)&&(l.openingElement.selfClosing=!0,delete l.closingElement);const s=e.call(a,"openingElement");if(l.openingElement.selfClosing)return assert.ok(!l.closingElement),s;const r=printJSXChildren(e,t,a);let o=!1,c=0;for(;r.length&&isLineNext(util.getLast(r));)willBreak(util.getLast(r))&&(++c,o=!0),r.pop();1<c&&r.push(hardline);let u=0;for(;r.length&&isLineNext(r[0]);)willBreak(r[0])&&(++u,o=!0),r.shift();1<u&&r.unshift(hardline);let h;if(1===r.length)!o&&willBreak(r[0])&&(o=!0),h=[concat([hardline,r[0]])];else{let y=[[]];r.forEach((g,x)=>{let f=r[x-1];f&&willBreak(f)?(o=!0,y.push([g])):util.getLast(y).push(g),!o&&x===r.length-1&&willBreak(g)&&(o=!0)}),h=[hardline,concat(y.map(g=>conditionalGroup([concat(g)])))]}const d=e.call(a,"closingElement"),m=group(concat([s,indent(t.tabWidth,group(concat(h),{shouldBreak:!0})),hardline,d]));return o?m:conditionalGroup([group(concat([s,concat(r),d])),m])}function maybeWrapJSXElementInParens(e,t,a){const l=e.getParentNode();if(!l)return t;return{JSXElement:!0,ExpressionStatement:!0,CallExpression:!0,ConditionalExpression:!0,LogicalExpression:!0}[l.type]?t:group(concat([ifBreak("("),indent(a.tabWidth,concat([softline,t])),softline,ifBreak(")")]))}function isBinaryish(e){return"BinaryExpression"===e.type||"LogicalExpression"===e.type}function printBinaryishExpressions(e,t,a,l,s){let r=e.getValue();return isBinaryish(r)?(util.getPrecedence(r.left.operator)===util.getPrecedence(r.operator)?e.call(o=>printBinaryishExpressions(o,t,a,l,!0),"left"):t.push(e.call(a,"left")),t.push(" ",r.operator,line,e.call(a,"right")),s&&r.comments&&t.push(comments.printComments(e,()=>"",l))):t.push(e.call(a)),t}function adjustClause(e,t,a){return""===e?";":isCurlyBracket(e)||a?concat([" ",e]):indent(t.tabWidth,concat([line,e]))}function isCurlyBracket(e){const t=getFirstString(e);return"{"===t||"{}"===t}function isEmptyBlock(e){const t=getFirstString(e);return"{}"===t}function lastNonSpaceCharacter(e){var t=e.lastPos();do{var a=e.charAt(t);if(/\S/.test(a))return a}while(e.prevPos(t))}function nodeStr(e,t){const a=e.value;if(isString.assert(a),"flow"===t.parser&&-1!==a.indexOf("\uFFFD"))return e.raw;const l=e.extra?e.extra.raw:e.raw,s=l.slice(1,-1),r={quote:"\"",regex:/"/g},o={quote:"'",regex:/'/g},c=t.singleQuote?o:r,u=c===o?r:o;let h=!1;if(s.includes(c.quote)){const m=(s.match(c.regex)||[]).length,y=(s.match(u.regex)||[]).length;h=m>y}const d=h?u.quote:c.quote;return makeString(s,d)}function makeString(e,t){const a="\""===t?"'":"\"",l=/\\([\s\S])|(['"])/g,s=e.replace(l,(r,o,c)=>{return o===a?o:c===t?"\\"+c:r});return t+s+t}function printNumber(e){return e.toLowerCase().replace(/^([\d.]+e)(?:\+|(-))?0*/,"$1$2").replace(/^\./,"0.").replace(/\.(?=e|$)/,"")}function isFirstStatement(e){const t=e.getParentNode(),a=e.getValue(),l=t.body;return l&&l[0]===a}function isLastStatement(e){const t=e.getParentNode(),a=e.getValue(),l=t.body;return l&&l[l.length-1]===a}function isObjectTypePropertyAFunction(e){return"ObjectTypeProperty"===e.type&&"FunctionTypeAnnotation"===e.value.type&&!e.static&&util.locStart(e.key)!==util.locStart(e.value)}function shouldPrintSameLine(e){const t=e.type;return namedTypes.Literal.check(e)||"ArrayExpression"===t||"ArrayPattern"===t||"ArrowFunctionExpression"===t||"AssignmentPattern"===t||"CallExpression"===t||"FunctionExpression"===t||"Identifier"===t||"JSXElement"===t||"Literal"===t||"MemberExpression"===t||"NewExpression"===t||"ObjectExpression"===t||"ObjectPattern"===t||"StringLiteral"===t||"ThisExpression"===t||"TypeCastExpression"===t||"UnaryExpression"===t}function printAstToDoc(e,t){function a(s){return comments.printComments(s,r=>genericPrint(r,t,a),t)}const l=a(FastPath.from(e));return docUtils.propagateBreaks(l),l}module.exports={printAstToDoc};

